

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qe_api_client.engine &mdash; Qlik Engine API Client 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Qlik Engine API Client
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Client Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../engine_communicator.html">Engine API Communicator Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../engine_api.html">Engine API Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_classes/index.html">API Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structs.html">Structs module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Qlik Engine API Client</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">qe_api_client.engine</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for qe_api_client.engine</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_app_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_app_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.engine_communicator</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_communicator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_field_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_field_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_generic_object_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_generic_object_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_global_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_global_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_generic_variable_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_generic_variable_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_generic_dimension_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_generic_dimension_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.api_classes.engine_generic_measure_api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">engine_generic_measure_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qe_api_client.structs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">structs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>


<div class="viewcode-block" id="QixEngine">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">QixEngine</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class of the client to interact with the Qlik Sense Engine API.</span>

<span class="sd">    Methods:</span>
<span class="sd">        select_in_dimension(app_handle, dimension_name, list_of_values): Selects values in a given field.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">user_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ca_certs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">certfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keyfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">app_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>

        <span class="c1"># Check, if server or local connection available</span>
        <span class="k">if</span> <span class="n">user_directory</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ca_certs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">certfile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">keyfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">engine_communicator</span><span class="o">.</span><span class="n">EngineCommunicator</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">engine_communicator</span><span class="o">.</span><span class="n">SecureEngineCommunicator</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">user_directory</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">ca_certs</span><span class="p">,</span> <span class="n">certfile</span><span class="p">,</span>
                                                                     <span class="n">keyfile</span><span class="p">,</span> <span class="n">app_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ega</span> <span class="o">=</span> <span class="n">engine_global_api</span><span class="o">.</span><span class="n">EngineGlobalApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span> <span class="o">=</span> <span class="n">engine_app_api</span><span class="o">.</span><span class="n">EngineAppApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span> <span class="o">=</span> <span class="n">engine_generic_object_api</span><span class="o">.</span><span class="n">EngineGenericObjectApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">efa</span> <span class="o">=</span> <span class="n">engine_field_api</span><span class="o">.</span><span class="n">EngineFieldApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">egva</span> <span class="o">=</span> <span class="n">engine_generic_variable_api</span><span class="o">.</span><span class="n">EngineGenericVariableApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">egda</span> <span class="o">=</span> <span class="n">engine_generic_dimension_api</span><span class="o">.</span><span class="n">EngineGenericDimensionApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">egma</span> <span class="o">=</span> <span class="n">engine_generic_measure_api</span><span class="o">.</span><span class="n">EngineGenericMeasureApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">structs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_handle</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<div class="viewcode-block" id="QixEngine.select_in_field">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.select_in_field">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_in_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">list_of_values</span><span class="p">):</span>
        <span class="n">lb_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">fld_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">lb_field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fld_handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;The field name &quot;</span> <span class="o">+</span> <span class="n">field_name</span> <span class="o">+</span> <span class="s2">&quot; doesn&#39;t exist!&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_to_select</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_of_values</span><span class="p">:</span>
                <span class="n">fld_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">field_value</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
                <span class="n">values_to_select</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fld_value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">efa</span><span class="o">.</span><span class="n">select_values</span><span class="p">(</span><span class="n">fld_handle</span><span class="p">,</span> <span class="n">values_to_select</span><span class="p">)</span></div>


<div class="viewcode-block" id="QixEngine.select_excluded_in_field">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.select_excluded_in_field">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_excluded_in_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">):</span>
        <span class="n">lb_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">fld_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">lb_field</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">efa</span><span class="o">.</span><span class="n">select_excluded</span><span class="p">(</span><span class="n">fld_handle</span><span class="p">)</span></div>


<div class="viewcode-block" id="QixEngine.select_possible_in_field">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.select_possible_in_field">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_possible_in_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">):</span>
        <span class="n">lb_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">fld_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">lb_field</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">efa</span><span class="o">.</span><span class="n">select_possible</span><span class="p">(</span><span class="n">fld_handle</span><span class="p">)</span></div>


    <span class="c1"># return a list of tuples where first value in tuple is the actual</span>
    <span class="c1"># data value and the second tuple value is that</span>
    <span class="c1"># values selection state</span>
<div class="viewcode-block" id="QixEngine.get_list_object_data">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_list_object_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_list_object_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">):</span>
        <span class="n">lb_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">fld_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">lb_field</span><span class="p">)</span>

        <span class="n">nx_inline_dimension_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_inline_dimension_def</span><span class="p">([</span><span class="n">field_name</span><span class="p">])</span>
        <span class="n">nx_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">efa</span><span class="o">.</span><span class="n">get_cardinal</span><span class="p">(</span><span class="n">fld_handle</span><span class="p">))</span>
        <span class="n">lb_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">list_object_def</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">nx_inline_dimension_def</span><span class="p">,</span>
                                              <span class="p">[</span><span class="n">nx_page</span><span class="p">])</span>

        <span class="c1"># Create info structure</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;ListObject&quot;</span><span class="p">,</span> <span class="n">obj_id</span><span class="o">=</span><span class="s2">&quot;SLB01&quot;</span><span class="p">)</span>

        <span class="c1"># Create generic object properties structure</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qListObjectDef&quot;</span><span class="p">,</span> <span class="n">prop_def</span><span class="o">=</span><span class="n">lb_def</span><span class="p">)</span>
        <span class="n">listobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>  <span class="c1"># NOQA</span>
        <span class="n">listobj_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">listobj</span><span class="p">)</span>
        <span class="n">val_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">listobj_handle</span><span class="p">)[</span><span class="s2">&quot;qListObject&quot;</span><span class="p">][</span><span class="s2">&quot;qDataPages&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;qMatrix&quot;</span><span class="p">]</span>  <span class="c1"># NOQA</span>
        <span class="n">val_n_state_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">val_list</span><span class="p">:</span>
            <span class="n">val_n_state_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;qText&quot;</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;qState&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">val_n_state_list</span></div>


<div class="viewcode-block" id="QixEngine.clear_selection_in_dimension">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.clear_selection_in_dimension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_selection_in_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">dimension_name</span><span class="p">):</span>
        <span class="n">lb_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">dimension_name</span><span class="p">)</span>
        <span class="n">fld_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">lb_field</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">efa</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">fld_handle</span><span class="p">)</span></div>



<div class="viewcode-block" id="QixEngine.create_single_master_dimension">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_single_master_dimension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_single_master_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dim_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dim_def</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dim_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                       <span class="n">dim_desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dim_tags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dim_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">dim_color_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">value_colors</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">null_value_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">null_value_color_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                       <span class="n">other_value_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">other_value_color_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                       <span class="n">single_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_color_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">palette</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
                                       <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a single master dimension.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            dim_title (str): The title of the dimension.</span>
<span class="sd">            dim_def (str): The definition of the dimension.</span>
<span class="sd">            dim_label (str, optional): The label of the dimension.</span>
<span class="sd">            dim_desc (str, optional): The description of the dimension.</span>
<span class="sd">            dim_tags (list, optional): The tags of the dimension.</span>
<span class="sd">            dim_color (str, optional): The master dimension color.</span>
<span class="sd">            dim_color_index (int, optional): The index of the master dimension color in the theme color picker.</span>
<span class="sd">            value_colors (list, optional): The value colors of the master dimension.</span>
<span class="sd">            null_value_color (str, optional): The NULL value color of the master dimension.</span>
<span class="sd">            null_value_color_index (int, optional): The index of the NULL value color of the master dimension in the theme color picker.</span>
<span class="sd">            other_value_color (str, optional): The OTHER value color of the master dimension.</span>
<span class="sd">            other_value_color_index (int, optional): The index of the OTHER value color of the master dimension in the theme color picker.</span>
<span class="sd">            single_color (str, optional): Single color of the values of the master dimension.</span>
<span class="sd">            single_color_index (int, optional): The index of single color of the values of the master dimension in the theme color picker.</span>
<span class="sd">            palette (str, optional): Choose a color palette, if there are more than one.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the dimension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value_colors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">dim_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim_tags</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Define of the single dimension properties</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;dimension&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">coloring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">dim_coloring</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coloring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">dim_coloring</span><span class="p">(</span><span class="n">base_color</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">dim_color</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">dim_color_index</span><span class="p">})</span>

        <span class="n">nx_library_dimension_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_library_dimension_def</span><span class="p">(</span><span class="n">grouping</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">field_definitions</span><span class="o">=</span><span class="p">[</span><span class="n">dim_def</span><span class="p">],</span>
                                                                         <span class="n">field_labels</span><span class="o">=</span><span class="p">[</span><span class="n">dim_title</span><span class="p">],</span>
                                                                         <span class="n">label_expression</span><span class="o">=</span><span class="n">dim_label</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">dim_title</span><span class="p">,</span>
                                                                         <span class="n">title</span><span class="o">=</span><span class="n">dim_title</span><span class="p">,</span> <span class="n">coloring</span><span class="o">=</span><span class="n">coloring</span><span class="p">)</span>
        <span class="n">gen_dim_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_dimension_properties</span><span class="p">(</span><span class="n">nx_info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span>
                                                                  <span class="n">nx_library_dimension_def</span><span class="o">=</span><span class="n">nx_library_dimension_def</span><span class="p">,</span>
                                                                  <span class="n">title</span><span class="o">=</span><span class="n">dim_title</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">dim_desc</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">dim_tags</span><span class="p">)</span>

        <span class="c1"># Create the single dimension</span>
        <span class="n">master_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_dimension</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_dim_props</span><span class="p">)</span>

        <span class="c1"># Get id and handle of the master dimension</span>
        <span class="n">master_dim_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">master_dim</span><span class="p">)</span>
        <span class="n">master_dim_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">master_dim</span><span class="p">)</span>

        <span class="c1"># Update &quot;colorMapRef&quot; property with the master dimension id.</span>
        <span class="n">patch_value</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">master_dim_id</span><span class="p">)</span>
        <span class="n">patch_color_map_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/qDim/coloring/colorMapRef&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">patch_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">master_dim_handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_color_map_ref</span><span class="p">])</span>

        <span class="c1"># Define the color properties</span>
        <span class="k">if</span> <span class="n">null_value_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">null_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">null_value</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">null_value_color</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">null_value_color_index</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">other_value_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">other_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">other_value</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">other_value_color</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">other_value_color_index</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">single_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">single</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">single</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">single_color</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">single_color_index</span><span class="p">}</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="n">value_colors</span>
        <span class="n">color_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">color_map</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">nul</span><span class="o">=</span><span class="n">null_value</span><span class="p">,</span> <span class="n">oth</span><span class="o">=</span><span class="n">other_value</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="n">single</span><span class="p">,</span> <span class="n">pal</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
        <span class="n">color_map_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">color_map_properties</span><span class="p">(</span><span class="n">dim_id</span><span class="o">=</span><span class="n">master_dim_id</span><span class="p">,</span> <span class="n">_color_map</span><span class="o">=</span><span class="n">color_map</span><span class="p">)</span>

        <span class="c1"># Create color map object, if colors are passed.</span>
        <span class="k">if</span> <span class="n">value_colors</span> <span class="ow">or</span> <span class="n">null_value_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">other_value_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">single_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color_map_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">color_map_props</span><span class="p">)</span>
            <span class="n">color_map_model_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">color_map_model</span><span class="p">)</span>

            <span class="c1"># Set &quot;autoFill&quot; and &quot;usePal&quot; to &quot;False&quot;, if a single color is passed.</span>
            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">single</span><span class="p">):</span>
                <span class="n">patch_value_use_pal_auto_fill</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">patch_use_pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/colorMap/usePal&quot;</span><span class="p">,</span>
                                                      <span class="n">value</span><span class="o">=</span><span class="n">patch_value_use_pal_auto_fill</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">color_map_model_handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_use_pal</span><span class="p">])</span>

                <span class="n">patch_auto_fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/colorMap/autoFill&quot;</span><span class="p">,</span>
                                                      <span class="n">value</span><span class="o">=</span><span class="n">patch_value_use_pal_auto_fill</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">color_map_model_handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_auto_fill</span><span class="p">])</span>

            <span class="c1"># Set &quot;autoFill&quot; to &quot;False&quot;, if a color palette is passed.</span>
            <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">patch_value_auto_fill</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">patch_auto_fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/colorMap/autoFill&quot;</span><span class="p">,</span>
                                                        <span class="n">value</span><span class="o">=</span><span class="n">patch_value_auto_fill</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">color_map_model_handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_auto_fill</span><span class="p">])</span>

        <span class="c1"># Update &quot;hasValueColors&quot; property, if value colors are passed.</span>
        <span class="k">if</span> <span class="n">value_colors</span><span class="p">:</span>
            <span class="n">patch_value_has_value_colors</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">patch_has_value_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/qDim/coloring/hasValueColors&quot;</span><span class="p">,</span>
                                                        <span class="n">value</span><span class="o">=</span><span class="n">patch_value_has_value_colors</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">master_dim_handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_has_value_colors</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">master_dim</span></div>



<div class="viewcode-block" id="QixEngine.create_master_measure">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_master_measure">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_master_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mes_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mes_def</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mes_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                              <span class="n">mes_desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mes_tags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mes_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">mes_color_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">gradient</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a master measure.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            mes_title (str): The title of the measure.</span>
<span class="sd">            mes_def (str): The definition of the measure.</span>
<span class="sd">            mes_label (str, optional): The label of the measure.</span>
<span class="sd">            mes_desc (str, optional): The description of the measure.</span>
<span class="sd">            mes_tags (list, optional): The tags of the measure.</span>
<span class="sd">            mes_color (str, optional): The color of the measure.</span>
<span class="sd">            mes_color_index (int, optional): The index of the color of the measure.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the measure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mes_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mes_tags</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Define of the measure properties</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;measure&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mes_color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">coloring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">mes_coloring</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coloring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">mes_coloring</span><span class="p">(</span><span class="n">base_color</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">mes_color</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">mes_color_index</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">gradient</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">coloring</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;gradient&quot;</span><span class="p">:</span> <span class="n">gradient</span><span class="p">})</span>

        <span class="n">nx_library_measure_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_library_measure_def</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">mes_title</span><span class="p">,</span> <span class="n">mes_def</span><span class="o">=</span><span class="n">mes_def</span><span class="p">,</span>
                                                                     <span class="n">label_expression</span><span class="o">=</span><span class="n">mes_label</span><span class="p">,</span> <span class="n">coloring</span><span class="o">=</span><span class="n">coloring</span><span class="p">)</span>
        <span class="n">gen_mes_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_measure_properties</span><span class="p">(</span><span class="n">nx_info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span>
                                                                <span class="n">nx_library_measure_def</span><span class="o">=</span><span class="n">nx_library_measure_def</span><span class="p">,</span>
                                                                <span class="n">title</span><span class="o">=</span><span class="n">mes_title</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">mes_desc</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">mes_tags</span><span class="p">)</span>

        <span class="c1"># Create the measure</span>
        <span class="n">master_mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_measure</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_mes_props</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">master_mes</span></div>


<div class="viewcode-block" id="QixEngine.create_sheet">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_sheet">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sheet_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sheet_desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">no_of_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">18</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a sheet.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            sheet_title (str): The title of the sheet.</span>
<span class="sd">            sheet_desc (str, optional): The description of the sheet.</span>
<span class="sd">            no_of_rows (int, optional): TThe number of the sheet rows. Min. 8 rows and max. 42 rows.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the sheet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define of the sheet properties</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;sheet&quot;</span><span class="p">)</span>
        <span class="n">sheet_def</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">sheet_title</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">sheet_desc</span><span class="p">}</span>
        <span class="n">sheet_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qMetaDef&quot;</span><span class="p">,</span> <span class="n">prop_def</span><span class="o">=</span><span class="n">sheet_def</span><span class="p">)</span>

        <span class="c1"># Add row and column attributes. The number of the row should be between 8 and 42.</span>
        <span class="k">if</span> <span class="n">no_of_rows</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">43</span><span class="p">):</span>
            <span class="n">no_of_rows</span> <span class="o">=</span> <span class="mi">18</span>
        <span class="n">no_of_columns</span> <span class="o">=</span> <span class="n">no_of_rows</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="c1"># Derive the grid_resolution property</span>
        <span class="k">if</span> <span class="n">no_of_rows</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">grid_resolution</span> <span class="o">=</span> <span class="s2">&quot;small&quot;</span>
        <span class="k">elif</span> <span class="n">no_of_rows</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">grid_resolution</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>
        <span class="k">elif</span> <span class="n">no_of_rows</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
            <span class="n">grid_resolution</span> <span class="o">=</span> <span class="s2">&quot;large&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grid_resolution</span> <span class="o">=</span> <span class="s2">&quot;customrows&quot;</span>

        <span class="c1"># Add new properties</span>
        <span class="n">sheet_props</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;thumbnail&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;qStaticContentUrlDef&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;qUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}},</span> <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">no_of_columns</span><span class="p">,</span> <span class="s2">&quot;rows&quot;</span><span class="p">:</span> <span class="n">no_of_rows</span><span class="p">,</span>
                <span class="s2">&quot;customRowBase&quot;</span><span class="p">:</span> <span class="n">no_of_rows</span><span class="p">,</span> <span class="s2">&quot;gridResolution&quot;</span><span class="p">:</span> <span class="n">grid_resolution</span><span class="p">,</span> <span class="s2">&quot;layoutOptions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mobileLayout&quot;</span><span class="p">:</span> <span class="s2">&quot;LIST&quot;</span><span class="p">},</span>
                <span class="s2">&quot;qChildListDef&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;qData&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;/title&quot;</span><span class="p">}}</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Create the sheet</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">sheet_props</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sheet</span></div>


<div class="viewcode-block" id="QixEngine.create_list_object">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_list_object">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_list_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dim_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">field_def</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">field_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a list object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            handle (int): The handle of the parent object.</span>
<span class="sd">            dim_id (str, optional): The ID of the master dimension. Let this parameter empty, if you passed the &quot;field_def&quot;.</span>
<span class="sd">            field_def (str, optional): The definition of the field. Let this parameter empty, if you passed the &quot;dim_id&quot;.</span>
<span class="sd">            field_title (int, optional): The title of the field. Let this parameter empty, if you passed the &quot;dim_id&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the list object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">field_def</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">field_def</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;listbox&quot;</span><span class="p">)</span>
        <span class="n">sort_criterias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">sort_criteria</span><span class="p">()</span>

        <span class="n">nx_library_dimension_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_inline_dimension_def</span><span class="p">(</span><span class="n">grouping</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">field_definitions</span><span class="o">=</span><span class="p">[</span><span class="n">field_def</span><span class="p">],</span>
                                                                          <span class="n">field_labels</span><span class="o">=</span><span class="p">[</span><span class="n">field_def</span><span class="p">],</span>
                                                                          <span class="n">sort_criterias</span><span class="o">=</span><span class="p">[</span><span class="n">sort_criterias</span><span class="p">])</span>
        <span class="n">list_object_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">list_object_def</span><span class="p">(</span><span class="n">library_id</span><span class="o">=</span><span class="n">dim_id</span><span class="p">,</span> <span class="n">definition</span><span class="o">=</span><span class="n">nx_library_dimension_def</span><span class="p">)</span>
        <span class="n">list_object_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qListObjectDef&quot;</span><span class="p">,</span>
                                                                   <span class="n">prop_def</span><span class="o">=</span><span class="n">list_object_def</span><span class="p">)</span>
        <span class="n">list_object_props</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;showTitles&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">field_title</span><span class="p">,</span> <span class="s2">&quot;subtitle&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;footnote&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;disableNavMenu&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
             <span class="s2">&quot;showDetails&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;showDetailsExpression&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;visualization&quot;</span><span class="p">:</span> <span class="s2">&quot;listbox&quot;</span><span class="p">})</span>
        <span class="n">list_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">create_child</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">list_object_props</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">list_object</span></div>


<div class="viewcode-block" id="QixEngine.create_filterpane_frame">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_filterpane_frame">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_filterpane_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">no_of_rows_sheet</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">colspan</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rowspan</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a filterpane frame.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            handle (int): The handle of the parent object.</span>
<span class="sd">            no_of_rows_sheet (int): The number of the sheet rows.</span>
<span class="sd">            col (int): First column the filterpane visualisation starts.</span>
<span class="sd">            row (int): First row the filterpane visualisation starts.</span>
<span class="sd">            colspan (int): The width of the filterpane in columns.</span>
<span class="sd">            rowspan (int): The height of the filterpane in rows.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the filterpane frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;filterpane&quot;</span><span class="p">)</span>
        <span class="n">filterpane_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qMetaDef&quot;</span><span class="p">)</span>
        <span class="n">filterpane_props</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;qChildListDef&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;qData&quot;</span><span class="p">:</span> <span class="p">{}}})</span>
        <span class="n">filterpane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">create_child</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">filterpane_props</span><span class="p">)</span>

        <span class="n">filterpane_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">filterpane</span><span class="p">)</span>

        <span class="n">no_of_cols_sheet</span> <span class="o">=</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">colspan</span> <span class="o">/</span> <span class="n">no_of_cols_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rowspan</span> <span class="o">/</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">row</span> <span class="o">/</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">col</span> <span class="o">/</span> <span class="n">no_of_cols_sheet</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">colspan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">no_of_cols_sheet</span> <span class="o">&gt;=</span> <span class="n">col</span> <span class="o">+</span> <span class="n">colspan</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">rowspan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">no_of_rows_sheet</span> <span class="o">&gt;=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">rowspan</span><span class="p">:</span>
            <span class="n">filterpane_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">object_position_size</span><span class="p">(</span><span class="n">obj_id</span><span class="o">=</span><span class="n">filterpane_id</span><span class="p">,</span> <span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;filterpane&quot;</span><span class="p">,</span>
                                                                         <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">,</span>
                                                                         <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                                                                         <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

            <span class="n">sheet_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;cells&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sheet_layout</span><span class="p">:</span>
                <span class="n">patch_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="n">filterpane_layout</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">patch_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/cells&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">patch_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">sheet_layout</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">]</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filterpane_layout</span><span class="p">)</span>
                <span class="n">patch_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">patch_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/cells&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">patch_value</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_cell</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The position of filterpane </span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">filterpane_id</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> is out of range. This one will not be created.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filterpane</span></div>



<div class="viewcode-block" id="QixEngine.create_chart">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_chart">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hypercube_def</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">no_of_rows_sheet</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                     <span class="n">colspan</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">rowspan</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a chart object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            handle (int): The handle of the parent object.</span>
<span class="sd">            obj_type (str): The type of the chart.</span>
<span class="sd">            hypercube_def (dict): Chart hypercube definition.</span>
<span class="sd">            no_of_rows_sheet (int): The number of the sheet rows.</span>
<span class="sd">            col (int): First column the chart visualisation starts.</span>
<span class="sd">            row (int): First row the chart visualisation starts.</span>
<span class="sd">            colspan (int): The width of the chart in columns.</span>
<span class="sd">            rowspan (int): The height of the chart in rows.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the filterpane frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="n">obj_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
            <span class="n">chart_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">table_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">hypercube_def</span><span class="o">=</span><span class="n">hypercube_def</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;sn-table&quot;</span><span class="p">:</span>
            <span class="n">chart_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">sn_table_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">hypercube_def</span><span class="o">=</span><span class="n">hypercube_def</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;pivot-table&quot;</span><span class="p">:</span>
            <span class="n">chart_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">pivot_table_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">hypercube_def</span><span class="o">=</span><span class="n">hypercube_def</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;sn-pivot-table&quot;</span><span class="p">:</span>
            <span class="n">chart_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">pivot_table_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">hypercube_def</span><span class="o">=</span><span class="n">hypercube_def</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not valid object type.&quot;</span><span class="p">)</span>

        <span class="n">chart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">create_child</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">chart_props</span><span class="p">)</span>

        <span class="n">chart_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>

        <span class="n">no_of_cols_sheet</span> <span class="o">=</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">colspan</span> <span class="o">/</span> <span class="n">no_of_cols_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rowspan</span> <span class="o">/</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">row</span> <span class="o">/</span> <span class="n">no_of_rows_sheet</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">col</span> <span class="o">/</span> <span class="n">no_of_cols_sheet</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">colspan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">no_of_cols_sheet</span> <span class="o">&gt;=</span> <span class="n">col</span> <span class="o">+</span> <span class="n">colspan</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">rowspan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">no_of_rows_sheet</span> <span class="o">&gt;=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">rowspan</span><span class="p">:</span>
            <span class="n">chart_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">object_position_size</span><span class="p">(</span><span class="n">obj_id</span><span class="o">=</span><span class="n">chart_id</span><span class="p">,</span> <span class="n">obj_type</span><span class="o">=</span><span class="n">obj_type</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                                             <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                                                             <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

            <span class="n">sheet_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;cells&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sheet_layout</span><span class="p">:</span>
                <span class="n">patch_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="n">chart_layout</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">patch_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/cells&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">patch_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">sheet_layout</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">]</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chart_layout</span><span class="p">)</span>
                <span class="n">patch_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">patch_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_patch</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/cells&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">patch_value</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">apply_patches</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">patches</span><span class="o">=</span><span class="p">[</span><span class="n">patch_cell</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The position of chart </span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">chart_id</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> is out of range. This one will not be created.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">chart</span></div>



<div class="viewcode-block" id="QixEngine.create_snapshot">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.create_snapshot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">object_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">snapshot_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">snapshot_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">show_titles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">object_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1280</span><span class="p">,</span> <span class="n">object_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">bounding_client_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1280</span><span class="p">,</span>
        <span class="n">bounding_client_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">rtl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">parent_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1280</span><span class="p">,</span> <span class="n">parent_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">720</span><span class="p">,</span>
        <span class="n">content_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1280</span><span class="p">,</span> <span class="n">content_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">720</span><span class="p">,</span> <span class="n">chart_data_scroll_offset_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">chart_data_scroll_offset_end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">53</span><span class="p">,</span> <span class="n">chart_data_legend_scroll_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">chart_data_zoom_min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">chart_data_zoom_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a snapshot object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            object_id (str): The id of the object.</span>
<span class="sd">            snapshot_title (str): The title of the snapshot.</span>
<span class="sd">            snapshot_description (str): The description of the snapshot.</span>
<span class="sd">            show_titles (bool): Enables / disables chart title.</span>
<span class="sd">            object_width (float): The width of the snapshot object.</span>
<span class="sd">            object_height (float): The height of the snapshot object.</span>
<span class="sd">            bounding_client_width (float): The width of the bounding client.</span>
<span class="sd">            bounding_client_height (float): The height of the bounding client.</span>
<span class="sd">            rtl (bool): Controls the rendering of content with right-to-left (RTL) language support.</span>
<span class="sd">            parent_width (float): The width of the parent object.</span>
<span class="sd">            parent_height (float): The height of the parent object.</span>
<span class="sd">            content_width (float): The width of the content object.</span>
<span class="sd">            content_height (float): The height of the content object.</span>
<span class="sd">            chart_data_scroll_offset_start (int): Scroll offset start.</span>
<span class="sd">            chart_data_scroll_offset_end (int): Scroll offset end.</span>
<span class="sd">            chart_data_legend_scroll_offset (int): Legend scroll offset.</span>
<span class="sd">            chart_data_zoom_min: Minimum chart data zoom.</span>
<span class="sd">            chart_data_zoom_max: Maximum chart data zoom.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The handle and Id of the created snapshot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get chart object</span>
        <span class="n">chart_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">object_id</span><span class="o">=</span><span class="n">object_id</span><span class="p">)</span>
        <span class="n">chart_obj_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">chart_obj</span><span class="p">)</span>

        <span class="c1"># Get sheet object</span>
        <span class="n">sheet_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_sheet</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">obj_id</span><span class="o">=</span><span class="n">object_id</span><span class="p">)</span>
        <span class="n">sheet_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">sheet_obj</span><span class="p">)</span>

        <span class="c1"># Get the visualization type</span>
        <span class="n">chart_obj_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">chart_obj_handle</span><span class="p">)</span>
        <span class="n">visualization</span> <span class="o">=</span> <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;visualization&quot;</span><span class="p">]</span>

        <span class="c1"># Attribut &quot;qInfo&quot; changed</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;qType&quot;</span><span class="p">:</span> <span class="s2">&quot;snapshot&quot;</span><span class="p">}</span>

        <span class="c1"># Attribut &quot;showTitles&quot; changed</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;showTitles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_titles</span>

        <span class="c1"># Attribut &quot;qMetaDef&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;qMetaDef&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">snapshot_title</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">snapshot_description</span><span class="p">}</span>

        <span class="c1"># Attribut &quot;creationDate&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;creationDate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Z&quot;</span>

        <span class="c1"># Attribut &quot;permissions&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;permissions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;publish&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;exportData&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                           <span class="s2">&quot;changeOwner&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

        <span class="c1"># Attribut &quot;visualizationType&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;visualizationType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">visualization</span>

        <span class="c1"># Attribut &quot;sourceObjectId&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;sourceObjectId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">object_id</span>

        <span class="c1"># Attribut &quot;sheetId&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;sheetId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet_id</span>

        <span class="c1"># Attribut &quot;timestamp&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Attribut &quot;isClone&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;isClone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Attribut &quot;supportExport&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;supportExport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Attribut &quot;qIncludeVariables&quot; added</span>
        <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;qIncludeVariables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Build the special snapshot parameters for the different chart types.</span>
        <span class="k">if</span> <span class="n">visualization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pivot-table&quot;</span><span class="p">]:</span>
            <span class="c1"># Attribut &quot;snapshotData&quot; added</span>
            <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;snapshotData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">object_height</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientWidth&quot;</span><span class="p">:</span> <span class="n">bounding_client_width</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientHeight&quot;</span><span class="p">:</span> <span class="n">bounding_client_height</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;rtl&quot;</span><span class="p">:</span> <span class="n">rtl</span><span class="p">,</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">parent_height</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">parent_width</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="k">elif</span> <span class="n">visualization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sn-table&quot;</span><span class="p">]:</span>
            <span class="c1"># Attribut &quot;snapshotData&quot; added</span>
            <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;snapshotData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="p">{</span>
					<span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
						<span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
						<span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">object_height</span><span class="p">,</span>
						<span class="s2">&quot;boundingClientWidth&quot;</span><span class="p">:</span> <span class="n">bounding_client_width</span><span class="p">,</span>
						<span class="s2">&quot;boundingClientHeight&quot;</span><span class="p">:</span> <span class="n">bounding_client_height</span>
					<span class="p">}</span>
				<span class="p">},</span>
				<span class="s2">&quot;rtl&quot;</span><span class="p">:</span> <span class="n">rtl</span><span class="p">,</span>
				<span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
					<span class="s2">&quot;scrollLeft&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
					<span class="s2">&quot;visibleLeft&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
					<span class="s2">&quot;visibleWidth&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
					<span class="s2">&quot;visibleTop&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
					<span class="s2">&quot;visibleHeight&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
					<span class="s2">&quot;rowsPerPage&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
					<span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
					<span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
						<span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
						<span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">object_height</span>
					<span class="p">},</span>
					<span class="s2">&quot;estimatedRowHeight&quot;</span><span class="p">:</span> <span class="mi">25</span>
				<span class="p">},</span>
				<span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
					<span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">parent_height</span><span class="p">,</span>
					<span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">parent_width</span>
				<span class="p">}</span>
			<span class="p">}</span>

        <span class="k">elif</span> <span class="n">visualization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sn-pivot-table&quot;</span><span class="p">]:</span>
            <span class="c1"># Attribut &quot;snapshotData&quot; added</span>
            <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;snapshotData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">object_height</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientWidth&quot;</span><span class="p">:</span> <span class="n">bounding_client_width</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientHeight&quot;</span><span class="p">:</span> <span class="n">bounding_client_height</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;rtl&quot;</span><span class="p">:</span> <span class="n">rtl</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;qPivotDataPages&quot;</span><span class="p">:</span> <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;qHyperCube&quot;</span><span class="p">][</span><span class="s2">&quot;qPivotDataPages&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;scrollTop&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;scrollLeft&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;leftGridScrollLeft&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;topGridScrollTop&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;rowsPerPage&quot;</span><span class="p">:</span> <span class="mi">15000</span>
                <span class="p">},</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">parent_height</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">parent_width</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="k">elif</span> <span class="n">visualization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;combochart&quot;</span><span class="p">,</span> <span class="s2">&quot;barchart&quot;</span><span class="p">]:</span>
            <span class="c1"># Attribut &quot;snapshotData&quot; added</span>
            <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;snapshotData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">object_height</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientWidth&quot;</span><span class="p">:</span> <span class="n">bounding_client_width</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientHeight&quot;</span><span class="p">:</span> <span class="n">bounding_client_height</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;rtl&quot;</span><span class="p">:</span> <span class="n">rtl</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">content_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">content_height</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;chartData&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;scrollOffset&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">chart_data_scroll_offset_start</span><span class="p">,</span>
                            <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">chart_data_scroll_offset_end</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;legendScrollOffset&quot;</span><span class="p">:</span> <span class="n">chart_data_legend_scroll_offset</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">parent_height</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">parent_width</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="k">elif</span> <span class="n">visualization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;linechart&quot;</span><span class="p">]:</span>
            <span class="c1"># Attribut &quot;snapshotData&quot; added</span>
            <span class="n">chart_obj_layout</span><span class="p">[</span><span class="s2">&quot;snapshotData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">object_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">object_height</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientWidth&quot;</span><span class="p">:</span> <span class="n">bounding_client_width</span><span class="p">,</span>
                        <span class="s2">&quot;boundingClientHeight&quot;</span><span class="p">:</span> <span class="n">bounding_client_height</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;rtl&quot;</span><span class="p">:</span> <span class="n">rtl</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">content_width</span><span class="p">,</span>
                        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">content_height</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;chartData&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">chart_data_zoom_min</span><span class="p">,</span>
                            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">chart_data_zoom_max</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">parent_height</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">parent_width</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chart type not supported.&quot;</span><span class="p">)</span>

        <span class="c1"># Create snapshot</span>
        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_bookmark</span><span class="p">(</span><span class="n">doc_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">chart_obj_layout</span><span class="p">)</span>
        <span class="n">snapshot</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;visualization&quot;</span><span class="p">:</span> <span class="n">visualization</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">snapshot</span></div>



<div class="viewcode-block" id="QixEngine.embed_snapshot">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.embed_snapshot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">embed_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">slide_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Embeds a created snapshot object on a slide.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            snapshot_id (str): The id of the snapshot.</span>
<span class="sd">            slide_id (str): The id of the slide to embed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the slide, where the snapshot should be embeded.</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">object_id</span><span class="o">=</span><span class="n">slide_id</span><span class="p">)</span>
        <span class="n">slide_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">slide</span><span class="p">)</span>

        <span class="c1"># Get the visualization type of the snapshot</span>
        <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_bookmark</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">bookmark_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">)</span>
        <span class="n">snapshot_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>
        <span class="n">snapshot_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">snapshot_handle</span><span class="p">)</span>
        <span class="n">visualization_type</span> <span class="o">=</span> <span class="n">snapshot_layout</span><span class="p">[</span><span class="s2">&quot;visualizationType&quot;</span><span class="p">]</span>

        <span class="c1"># create the snapshot</span>
        <span class="n">slideitem_snapshot_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">slideitem_snapshot_properties</span><span class="p">(</span><span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">,</span>
                                                                                   <span class="n">visualization_type</span><span class="o">=</span><span class="n">visualization_type</span><span class="p">)</span>
        <span class="n">slideitem_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">create_child</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">slide_handle</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">slideitem_snapshot_properties</span><span class="p">)</span>
        <span class="n">slideitem_snapshot_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">slideitem_snapshot</span><span class="p">)</span>

        <span class="n">slideitem_snapshot_embeded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">embed_snapshot_object</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">slideitem_snapshot_handle</span><span class="p">,</span>
                                                                     <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">)</span></div>



<div class="viewcode-block" id="QixEngine.get_app_lineage_info">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_lineage_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_lineage_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the lineage information of the app. The lineage information includes the LOAD and STORE statements from</span>
<span class="sd">        the data load script associated with this app.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">        DataFrame: Information about the lineage of the data in the app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Lineage-Daten aus der API holen</span>
        <span class="n">lineage_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_lineage</span><span class="p">(</span><span class="n">app_handle</span><span class="p">)</span>

        <span class="c1"># Erstelle den DataFrame und fülle fehlende Werte mit &quot;&quot;</span>
        <span class="n">df_lineage_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lineage_info</span><span class="p">)</span>
        <span class="n">df_lineage_info</span> <span class="o">=</span> <span class="n">df_lineage_info</span><span class="p">[(</span><span class="n">df_lineage_info</span><span class="p">[</span><span class="s2">&quot;qDiscriminator&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_lineage_info</span><span class="p">[</span><span class="s2">&quot;qStatement&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df_lineage_info</span></div>


<div class="viewcode-block" id="QixEngine.disconnect">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.disconnect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close_qvengine_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span></div>


<div class="viewcode-block" id="QixEngine.get_handle">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_handle">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_handle</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the handle from a given object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        obj : dict</span>
<span class="sd">            The object containing the handle.</span>

<span class="sd">        Returns:</span>
<span class="sd">        int: The handle value.</span>

<span class="sd">        Raises:</span>
<span class="sd">        ValueError: If the handle value is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;qHandle&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Bad handle value in &quot;</span> <span class="o">+</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="QixEngine.get_id">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_id">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_id</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the id from a given object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        obj : dict</span>
<span class="sd">            The object containing the id.</span>

<span class="sd">        Returns:</span>
<span class="sd">        int: The id value.</span>

<span class="sd">        Raises:</span>
<span class="sd">        ValueError: If the id value is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;qGenericId&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Bad id value in &quot;</span> <span class="o">+</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="QixEngine.get_type">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_type">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the type from a given object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        obj : dict</span>
<span class="sd">            The object containing the type.</span>

<span class="sd">        Returns:</span>
<span class="sd">        int: The type value.</span>

<span class="sd">        Raises:</span>
<span class="sd">        ValueError: If the type value is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;qGenericType&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Bad type value in &quot;</span> <span class="o">+</span> <span class="n">obj</span></div>



<div class="viewcode-block" id="QixEngine.get_object_sheet">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_object_sheet">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the sheet from a given chart object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            obj_id (str): The ID of the object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The sheet object with handle and id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parent_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">object_id</span><span class="o">=</span><span class="n">obj_id</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="n">parent_obj</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sheet&quot;</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">parent_obj</span>
            <span class="n">obj_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">parent_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_parent</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parent_obj</span></div>



<div class="viewcode-block" id="QixEngine.get_chart_data">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_chart_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_chart_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the data from a given chart object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            obj_id (str): The ID of the chart object.</span>

<span class="sd">        Returns:</span>
<span class="sd">        DataFrame: A table of the chart content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get object ID</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;qType&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Chart ID does not exists!&#39;</span>


        <span class="c1"># Get object handle</span>
        <span class="n">obj_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="c1"># Get object layout</span>
        <span class="n">obj_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">obj_handle</span><span class="p">)</span>

        <span class="c1"># Determine the number of the columns and the rows the table has and splits in certain circumstances the table</span>
        <span class="c1"># calls</span>
        <span class="n">no_of_columns</span> <span class="o">=</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qSize&#39;</span><span class="p">][</span><span class="s1">&#39;qcx&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">no_of_columns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;The chart either contains no columns or has a calculation condition!&#39;</span>

        <span class="n">width</span> <span class="o">=</span> <span class="n">no_of_columns</span>
        <span class="n">no_of_rows</span> <span class="o">=</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qSize&#39;</span><span class="p">][</span><span class="s1">&#39;qcy&#39;</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">10000</span> <span class="o">/</span> <span class="n">no_of_columns</span><span class="p">))</span>

        <span class="c1"># Extract the dimension and measure titles and concat them to column names.</span>
        <span class="n">dimension_info</span> <span class="o">=</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qDimensionInfo&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">measure_info</span> <span class="o">=</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qMeasureInfo&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">column_info</span> <span class="o">=</span> <span class="n">dimension_info</span> <span class="o">+</span> <span class="n">measure_info</span>

        <span class="c1"># Build the column mapping using qEffectiveInterColumnSortOrder</span>
        <span class="n">sort_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qEffectiveInterColumnSortOrder&#39;</span><span class="p">])</span>
        <span class="n">sort_order_positive</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sort_order</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sort_order_positive</span><span class="p">:</span>
            <span class="n">column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column_info</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;qFallbackTitle&quot;</span><span class="p">])</span>

        <span class="c1"># if the type of the charts has a straight data structure</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qInfo&#39;</span><span class="p">][</span><span class="s1">&#39;qType&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;sn-table&#39;</span><span class="p">,</span> <span class="s1">&#39;piechart&#39;</span><span class="p">,</span> <span class="s1">&#39;scatterplot&#39;</span><span class="p">,</span> <span class="s1">&#39;combochart&#39;</span><span class="p">,</span> <span class="s1">&#39;barchart&#39;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qDataPages&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]):</span>

            <span class="c1"># Paging variables</span>
            <span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">data_values</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Retrieves the hypercube data in a loop (because of limitation from 10.000 cells per call)</span>
            <span class="k">while</span> <span class="n">no_of_rows</span> <span class="o">&gt;</span> <span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">:</span>
                <span class="n">nx_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
                <span class="n">hc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page</span><span class="p">])[</span>
                    <span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qMatrix&#39;</span><span class="p">]</span>
                <span class="n">data_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">hc_data</span><span class="p">)</span>
                <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Creates Dataframe from the content of the attribute &#39;qText&#39;.</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;qText&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">data_values</span><span class="p">])</span>

            <span class="c1"># Assign titles zu Dataframe columns</span>
            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>

        <span class="c1"># if the type of the charts has a pivot data structure</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qInfo&#39;</span><span class="p">][</span><span class="s1">&#39;qType&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pivot-table&#39;</span><span class="p">,</span> <span class="s1">&#39;sn-pivot-table&#39;</span><span class="p">]</span>
              <span class="ow">and</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qPivotDataPages&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]):</span>

            <span class="c1"># Supporting function to traverse all subnodes to get all dimensions</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">get_all_dimensions</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qText&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Leerer String, falls nicht vorhanden</span>
                <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

                <span class="k">if</span> <span class="s1">&#39;qSubNodes&#39;</span> <span class="ow">in</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]:</span>
                    <span class="n">sub_dimensions</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">sub_node</span> <span class="ow">in</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]:</span>
                        <span class="n">sub_dimensions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">dimensions</span> <span class="o">+</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">get_all_dimensions</span><span class="p">(</span><span class="n">sub_node</span><span class="p">)])</span>
                    <span class="k">return</span> <span class="n">sub_dimensions</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="n">dimensions</span><span class="p">]</span>

            <span class="c1"># Supporting function to get all column headers for the pivot table</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">get_column_paths</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qText&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">current_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

                <span class="k">if</span> <span class="s1">&#39;qSubNodes&#39;</span> <span class="ow">in</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]:</span>
                    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">get_column_paths</span><span class="p">(</span><span class="n">sub</span><span class="p">):</span>
                            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_path</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">paths</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="n">current_path</span><span class="p">]</span>

            <span class="n">col_headers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nx_page_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">hc_top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_pivot_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page_top</span><span class="p">])[</span><span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qTop&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">top_node</span> <span class="ow">in</span> <span class="n">hc_top</span><span class="p">:</span>
                <span class="n">col_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_column_paths</span><span class="p">(</span><span class="n">top_node</span><span class="p">))</span>

            <span class="c1"># Paging variables</span>
            <span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">row_headers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">data_values</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Retrieves the hypercube data in a loop (bacause of limitation from 10.000 cells per call)</span>
            <span class="k">while</span> <span class="n">no_of_rows</span> <span class="o">&gt;</span> <span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">:</span>
                <span class="n">nx_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

                <span class="c1"># Retrieves the row headers for the pivot table</span>
                <span class="n">hc_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_pivot_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page</span><span class="p">])[</span>
                    <span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qLeft&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">left_node</span> <span class="ow">in</span> <span class="n">hc_left</span><span class="p">:</span>
                    <span class="n">row_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_all_dimensions</span><span class="p">(</span><span class="n">left_node</span><span class="p">))</span>

                <span class="c1"># Retrieves the data for the pivot table</span>
                <span class="n">hc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_pivot_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page</span><span class="p">])[</span>
                    <span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qData&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">hc_data</span><span class="p">:</span>
                    <span class="n">data_values</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cell</span><span class="p">[</span><span class="s1">&#39;qText&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span>

                <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Creates multi indes for rows and columns</span>
            <span class="n">row_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">row_headers</span><span class="p">)</span>
            <span class="n">col_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">col_headers</span><span class="p">)</span>

            <span class="c1"># Creates the Dataframe</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">row_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_index</span><span class="p">)</span>
            <span class="n">index_levels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[:</span><span class="n">index_levels</span><span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="c1"># if the type of the charts has a stacked data structure</span>
        <span class="k">elif</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qInfo&#39;</span><span class="p">][</span><span class="s1">&#39;qType&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;barchart&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qStackedDataPages&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">max_no_cells</span> <span class="o">=</span> <span class="n">no_of_columns</span> <span class="o">*</span> <span class="n">no_of_rows</span>
            <span class="n">nx_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">no_of_columns</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">no_of_rows</span><span class="p">)</span>
            <span class="n">hc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_stack_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page</span><span class="p">],</span> <span class="n">max_no_cells</span><span class="o">=</span><span class="n">max_no_cells</span><span class="p">)[</span>
                <span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qData&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]</span>

            <span class="c1"># Transform the nested structure into a flat DataFrame</span>
            <span class="n">data_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hc_data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sub_node</span> <span class="ow">in</span> <span class="n">node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">sub_node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qValue&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">sub_node</span><span class="p">[</span><span class="s1">&#39;qSubNodes&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">data_values</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;qText&#39;</span><span class="p">],</span> <span class="n">sub_node</span><span class="p">[</span><span class="s1">&#39;qText&#39;</span><span class="p">],</span> <span class="n">value</span><span class="p">])</span>

            <span class="c1"># Creates the Dataframe</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Chart type not supported.&#39;</span>

        <span class="c1"># Returns the Dataframe</span>
        <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="QixEngine.get_constructed_table_data">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_constructed_table_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_constructed_table_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">,</span> <span class="n">list_of_dimensions</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">list_of_measures</span> <span class="o">=</span> <span class="p">[],</span>
                                  <span class="n">list_of_master_dimensions</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">list_of_master_measures</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a table from given fields, expressions, dimensions or measures and retrieves the data from it.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>
<span class="sd">            list_of_dimensions (list): A list of dimensions.</span>
<span class="sd">            list_of_measures (list): A list of measures.</span>
<span class="sd">            list_of_master_dimensions (list): A list of master dimensions.</span>
<span class="sd">            list_of_master_measures (list): A list of master measures.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table of the chart content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create dimension property</span>
        <span class="n">hc_dim</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="n">list_of_dimensions</span><span class="p">:</span>
            <span class="n">hc_inline_dim_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_inline_dimension_def</span><span class="p">(</span><span class="n">field_definitions</span><span class="o">=</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span>
            <span class="n">hc_dim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_dimension</span><span class="p">(</span><span class="n">library_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dim_def</span><span class="o">=</span><span class="n">hc_inline_dim_def</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="n">list_of_master_dimensions</span><span class="p">:</span>
            <span class="n">hc_dim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_dimension</span><span class="p">(</span><span class="n">library_id</span><span class="o">=</span><span class="n">dimension</span><span class="p">))</span>

        <span class="c1"># Create measure property</span>
        <span class="n">hc_mes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">list_of_measures</span><span class="p">:</span>
            <span class="n">hc_inline_mes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_inline_measure_def</span><span class="p">(</span><span class="n">definition</span><span class="o">=</span><span class="n">measure</span><span class="p">)</span>
            <span class="n">hc_mes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_measure</span><span class="p">(</span><span class="n">library_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mes_def</span><span class="o">=</span><span class="n">hc_inline_mes</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">list_of_master_measures</span><span class="p">:</span>
            <span class="n">hc_mes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_measure</span><span class="p">(</span><span class="n">library_id</span><span class="o">=</span><span class="n">measure</span><span class="p">))</span>

        <span class="c1"># Create hypercube structure</span>
        <span class="n">hc_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">hypercube_def</span><span class="p">(</span><span class="n">state_name</span><span class="o">=</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">hc_dim</span><span class="p">,</span> <span class="n">measures</span><span class="o">=</span><span class="n">hc_mes</span><span class="p">)</span>

        <span class="c1"># Create info structure</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">)</span>

        <span class="c1"># Create generic object properties structure</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qHyperCubeDef&quot;</span><span class="p">,</span> <span class="n">prop_def</span><span class="o">=</span><span class="n">hc_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">hc_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get object handle</span>
        <span class="n">hc_obj_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">hc_obj</span><span class="p">)</span>

        <span class="c1"># Get object layout</span>
        <span class="n">hc_obj_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">hc_obj_handle</span><span class="p">)</span>

        <span class="c1"># Determine the number of the columns and the rows the table has and splits in certain circumstances the table calls</span>
        <span class="n">no_of_columns</span> <span class="o">=</span> <span class="n">hc_obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qSize&#39;</span><span class="p">][</span><span class="s1">&#39;qcx&#39;</span><span class="p">]</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">no_of_columns</span>
        <span class="n">no_of_rows</span> <span class="o">=</span> <span class="n">hc_obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qSize&#39;</span><span class="p">][</span><span class="s1">&#39;qcy&#39;</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">10000</span> <span class="o">/</span> <span class="n">no_of_columns</span><span class="p">))</span>

        <span class="c1"># Extract the dimension and measure titles and concat them to column names.</span>
        <span class="n">dimension_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">[</span><span class="s1">&#39;qFallbackTitle&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">hc_obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qDimensionInfo&#39;</span><span class="p">]]</span>
        <span class="n">measure_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure</span><span class="p">[</span><span class="s1">&#39;qFallbackTitle&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">hc_obj_layout</span><span class="p">[</span><span class="s1">&#39;qHyperCube&#39;</span><span class="p">][</span><span class="s1">&#39;qMeasureInfo&#39;</span><span class="p">]]</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="n">dimension_titles</span> <span class="o">+</span> <span class="n">measure_titles</span>

        <span class="c1"># Paging variables</span>
        <span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">data_values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Retrieves the hypercube data in a loop (because of limitation from 10.000 cells per call)</span>
        <span class="k">while</span> <span class="n">no_of_rows</span> <span class="o">&gt;</span> <span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">:</span>
            <span class="n">nx_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_page</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">page</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
            <span class="n">hc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_hypercube_data</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">hc_obj_handle</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/qHyperCubeDef&#39;</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">[</span><span class="n">nx_page</span><span class="p">])[</span><span class="s1">&#39;qDataPages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;qMatrix&#39;</span><span class="p">]</span>
            <span class="n">data_values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">hc_data</span><span class="p">)</span>
            <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Creates Dataframe from the content of the attribute &#39;qText&#39;.</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;qText&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">data_values</span><span class="p">])</span>

        <span class="c1"># Assign titles zu Dataframe columns</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span>

        <span class="c1"># Returns the Dataframe</span>
        <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="QixEngine.get_apps">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_apps">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all apps on the server containing metadata.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all server apps.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get all apps from Qlik Server</span>
        <span class="n">doc_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ega</span><span class="o">.</span><span class="n">get_doc_list</span><span class="p">()</span>

        <span class="c1"># Convert into DataFrame structure</span>
        <span class="n">df_doc_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">doc_list</span><span class="p">)</span>

        <span class="c1"># Resolve the attribute &quot;qMeta&quot;</span>
        <span class="n">field_meta</span> <span class="o">=</span> <span class="n">df_doc_list</span><span class="p">[</span><span class="s1">&#39;qMeta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;createdDate&quot;</span><span class="p">,</span> <span class="s2">&quot;modifiedDate&quot;</span><span class="p">,</span> <span class="s2">&quot;published&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;publishTime&quot;</span><span class="p">,</span> <span class="s2">&quot;privileges&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;qStaticByteSize&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamicColor&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;stream&quot;</span><span class="p">,</span> <span class="s2">&quot;canCreateDataConnections&quot;</span><span class="p">])</span>

        <span class="c1"># Concat the resolved attribute and rename the new columns</span>
        <span class="n">df_doc_list_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_doc_list</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;qMeta&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">field_meta</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_doc_list_meta</span> <span class="o">=</span> <span class="n">df_doc_list_meta</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;createdDate&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_createdDate&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;modifiedDate&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_modifiedDate&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;published&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_published&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;publishTime&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_publishTime&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;privileges&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_privileges&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_description&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;qStaticByteSize&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_qStaticByteSize&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;dynamicColor&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_dynamicColor&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_create&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_stream&quot;</span><span class="p">,</span>
                                                            <span class="s2">&quot;canCreateDataConnections&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_canCreateDataConnections&quot;</span><span class="p">})</span>

        <span class="c1"># Resolve the attribute &quot;stream&quot;</span>
        <span class="n">field_meta_stream</span> <span class="o">=</span> <span class="n">df_doc_list_meta</span><span class="p">[</span><span class="s1">&#39;qMeta_stream&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="c1"># Concat the resolved attribute and rename the new columns</span>
        <span class="n">df_doc_list_meta_stream</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_doc_list_meta</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;qMeta_stream&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">field_meta_stream</span><span class="p">],</span>
                                            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_doc_list_meta_stream</span> <span class="o">=</span> <span class="n">df_doc_list_meta_stream</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_stream_id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;qMeta_stream_name&quot;</span><span class="p">})</span>

        <span class="c1"># Resolve the attribute &quot;qThumbnail&quot;</span>
        <span class="n">field_thumbnail</span> <span class="o">=</span> <span class="n">df_doc_list_meta_stream</span><span class="p">[</span><span class="s1">&#39;qThumbnail&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qUrl&quot;</span><span class="p">])</span>

        <span class="c1">## Concat the resolved attribute and rename the new columns</span>
        <span class="n">df_doc_list_resolved</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_doc_list_meta_stream</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;qThumbnail&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">field_thumbnail</span><span class="p">],</span>
                                         <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_doc_list_resolved</span> <span class="o">=</span> <span class="n">df_doc_list_resolved</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;qUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;qThumbnail_qUrl&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_doc_list_resolved</span></div>



<div class="viewcode-block" id="QixEngine.get_app_fields">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_fields">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all app fields containing meta data.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all fields from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the parameters of the session object</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;FieldList&quot;</span><span class="p">)</span>
        <span class="n">field_list_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">field_list_def</span><span class="p">()</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qFieldListDef&quot;</span><span class="p">,</span>
                                                               <span class="n">prop_def</span><span class="o">=</span><span class="n">field_list_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get session handle</span>
        <span class="n">session_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

        <span class="c1"># Get session object data</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">session_handle</span><span class="p">)</span>

        <span class="c1"># Get the field list as Dictionary structure</span>
        <span class="n">fields_list</span> <span class="o">=</span> <span class="n">layout</span><span class="p">[</span><span class="s2">&quot;qFieldList&quot;</span><span class="p">][</span><span class="s2">&quot;qItems&quot;</span><span class="p">]</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_fields_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;qIsHidden&#39;</span><span class="p">,</span> <span class="s1">&#39;qIsSystem&#39;</span><span class="p">,</span> <span class="s1">&#39;qName&#39;</span><span class="p">,</span> <span class="s1">&#39;qCardinal&#39;</span><span class="p">,</span> <span class="s1">&#39;qTags&#39;</span><span class="p">,</span> <span class="s1">&#39;qSrcTables&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">fields</span> <span class="ow">in</span> <span class="n">fields_list</span><span class="p">:</span>
            <span class="c1"># Concatenate the field list on the DataFrame structure</span>
            <span class="n">df_fields_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_fields_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fields</span>

        <span class="k">return</span> <span class="n">df_fields_list</span></div>



<div class="viewcode-block" id="QixEngine.get_app_dimensions">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_dimensions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all app dimensions containing metadata.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all dimensions from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the parameters of the session object</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;DimensionList&quot;</span><span class="p">)</span>
        <span class="n">dimension_list_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">dimension_list_def</span><span class="p">()</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qDimensionListDef&quot;</span><span class="p">,</span>
                                                               <span class="n">prop_def</span><span class="o">=</span><span class="n">dimension_list_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get session handle</span>
        <span class="n">session_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

        <span class="c1"># Get session object data</span>
        <span class="n">session_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">session_handle</span><span class="p">)</span>

        <span class="c1"># Get the dimension list as Dictionary structure</span>
        <span class="n">dimension_list</span> <span class="o">=</span> <span class="n">session_layout</span><span class="p">[</span><span class="s2">&quot;qDimensionList&quot;</span><span class="p">][</span><span class="s2">&quot;qItems&quot;</span><span class="p">]</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;qMeta&quot;</span><span class="p">,</span> <span class="s2">&quot;qDim&quot;</span><span class="p">,</span> <span class="s2">&quot;qDimInfos&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="n">dimension_list</span><span class="p">:</span>
            <span class="c1"># Get dimension ID</span>
            <span class="n">dim_id</span> <span class="o">=</span> <span class="n">dimension</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">][</span><span class="s2">&quot;qId&quot;</span><span class="p">]</span>
            <span class="c1"># Get dimension</span>
            <span class="n">dim_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egda</span><span class="o">.</span><span class="n">get_dimension</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">dimension_id</span><span class="o">=</span><span class="n">dim_id</span><span class="p">)</span>
            <span class="c1"># Get dimension handle</span>
            <span class="n">dim_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">dim_result</span><span class="p">)</span>
            <span class="c1"># Get dimension metadata</span>
            <span class="n">dim_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">dim_handle</span><span class="p">)</span>

            <span class="c1"># Concatenate the dimension to the DataFrame structure</span>
            <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_dimension_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dim_layout</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qInfo&quot;</span>
        <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qInfo_&quot;</span><span class="p">))</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_dimension_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeta&quot;</span>
        <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeta_&quot;</span><span class="p">))</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_dimension_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qDim&quot;</span>
        <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDim&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qDim_&quot;</span><span class="p">))</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qDim&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_dimension_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qDim_coloring&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDim_coloring&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qDim_coloring_&quot;</span><span class="p">))</span>
            <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qDim_coloring&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_dimension_list_expanded</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDim_coloring&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qDim_coloring_baseColor&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDim_coloring_baseColor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qDim_coloring_baseColor_&quot;</span><span class="p">))</span>
            <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qDim_coloring_baseColor&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">df_dimension_list_expanded</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDim_coloring_baseColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Resolve the list structure of attribute</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">explode</span><span class="p">([</span><span class="s1">&#39;qDimInfos&#39;</span><span class="p">,</span> <span class="s1">&#39;qDim_qFieldDefs&#39;</span><span class="p">,</span> <span class="s1">&#39;qDim_qFieldLabels&#39;</span><span class="p">])</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qDimInfos&quot;</span>
        <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_dimension_list</span><span class="p">[</span><span class="s2">&quot;qDimInfos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qDimInfos_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_dimension_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_dimension_list_expanded</span> <span class="o">=</span> <span class="n">df_dimension_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_dimension_list</span> <span class="o">=</span> <span class="n">df_dimension_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qDimInfos&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_dimension_list_expanded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_dimension_list</span></div>



<div class="viewcode-block" id="QixEngine.get_app_measures">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_measures">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_measures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all app measures containing metadata.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all measures from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the parameters of the session object</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;MeasureList&quot;</span><span class="p">)</span>
        <span class="n">measure_list_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">measure_list_def</span><span class="p">()</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qMeasureListDef&quot;</span><span class="p">,</span>
                                                               <span class="n">prop_def</span><span class="o">=</span><span class="n">measure_list_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get session handle</span>
        <span class="n">session_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

        <span class="c1"># Get session object data</span>
        <span class="n">session_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">session_handle</span><span class="p">)</span>

        <span class="c1"># Get the measure list as Dictionary structure</span>
        <span class="n">measure_list</span> <span class="o">=</span> <span class="n">session_layout</span><span class="p">[</span><span class="s2">&quot;qMeasureList&quot;</span><span class="p">][</span><span class="s2">&quot;qItems&quot;</span><span class="p">]</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;qMeasure&quot;</span><span class="p">,</span> <span class="s2">&quot;qMeta&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">measure_list</span><span class="p">:</span>
            <span class="c1"># Get measure ID</span>
            <span class="n">measure_id</span> <span class="o">=</span> <span class="n">measure</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">][</span><span class="s2">&quot;qId&quot;</span><span class="p">]</span>
            <span class="c1"># Get measure</span>
            <span class="n">measure_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egma</span><span class="o">.</span><span class="n">get_measure</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">measure_id</span><span class="o">=</span><span class="n">measure_id</span><span class="p">)</span>
            <span class="c1"># Get measure handle</span>
            <span class="n">measure_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">measure_result</span><span class="p">)</span>
            <span class="c1"># Get session object data</span>
            <span class="n">measure_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">measure_handle</span><span class="p">)</span>

            <span class="c1"># Concatenate the measure metadata to the DataFrame structure</span>
            <span class="n">df_measure_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_measure_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">measure_layout</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qInfo&quot;</span>
        <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qInfo_&quot;</span><span class="p">))</span>
        <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_measure_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeasure&quot;</span>
        <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeasure_&quot;</span><span class="p">))</span>
        <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeasure&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_measure_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeta&quot;</span>
        <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeta_&quot;</span><span class="p">))</span>
        <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_measure_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeasure_qNumFormat&quot;</span>
        <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure_qNumFormat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeasure_qNumFormat_&quot;</span><span class="p">))</span>
        <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeasure_qNumFormat&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_measure_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeasure_coloring&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeasure_coloring_&quot;</span><span class="p">))</span>
            <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_measure_list_expanded</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeasure_coloring_baseColor&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_measure_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring_baseColor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span>
                <span class="s2">&quot;qMeasure_coloring_baseColor_&quot;</span><span class="p">))</span>
            <span class="n">df_measure_list</span> <span class="o">=</span> <span class="n">df_measure_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring_baseColor&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">df_measure_list_expanded</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">df_measure_list</span><span class="p">[</span><span class="s2">&quot;qMeasure_coloring_baseColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">df_measure_list</span></div>



<div class="viewcode-block" id="QixEngine.get_app_sheets">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_sheets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all app sheets and their content containing metadata.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all sheets and their content from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the parameters of the session object</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;SheetList&quot;</span><span class="p">)</span>
        <span class="n">sheet_list_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">sheet_list_def</span><span class="p">()</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qAppObjectListDef&quot;</span><span class="p">,</span>
                                                               <span class="n">prop_def</span><span class="o">=</span><span class="n">sheet_list_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get session handle</span>
        <span class="n">session_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

        <span class="c1"># Get session object data</span>
        <span class="n">session_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">session_handle</span><span class="p">)</span>

        <span class="c1"># Get the sheet list as Dictionary structure</span>
        <span class="n">sheet_list</span> <span class="o">=</span> <span class="n">session_layout</span><span class="p">[</span><span class="s2">&quot;qAppObjectList&quot;</span><span class="p">][</span><span class="s2">&quot;qItems&quot;</span><span class="p">]</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;qInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;qMeta&#39;</span><span class="p">,</span> <span class="s1">&#39;qSelectionInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;rank&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="s1">&#39;rows&#39;</span><span class="p">,</span> <span class="s1">&#39;cells&#39;</span><span class="p">,</span> <span class="s1">&#39;qChildList&#39;</span><span class="p">,</span> <span class="s1">&#39;gridResolution&#39;</span><span class="p">,</span> <span class="s1">&#39;layoutOptions&#39;</span><span class="p">,</span> <span class="s1">&#39;gridMode&#39;</span><span class="p">,</span> <span class="s1">&#39;customRowBase&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">sheet_list</span><span class="p">:</span>
            <span class="c1"># Get sheet ID</span>
            <span class="n">sheet_id</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">][</span><span class="s2">&quot;qId&quot;</span><span class="p">]</span>
            <span class="c1"># Get sheet</span>
            <span class="n">sheet_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">app_handle</span><span class="o">=</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">object_id</span><span class="o">=</span><span class="n">sheet_id</span><span class="p">)</span>
            <span class="c1"># Get sheet handle</span>
            <span class="n">sheet_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">sheet_result</span><span class="p">)</span>
            <span class="c1"># Get session object data</span>
            <span class="n">sheet_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">sheet_handle</span><span class="p">)</span>

            <span class="c1"># Concatenate the measure metadata to the DataFrame structure</span>
            <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sheet_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sheet_layout</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qInfo&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qInfo_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeta&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeta_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qSelectionInfo&quot;</span>
        <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qSelectionInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qSelectionInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qSelectionInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qSelectionInfo_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qSelectionInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;thumbnail&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;thumbnail&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;thumbnail_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;thumbnail&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;thumbnail_qStaticContentUrl&quot;</span>
        <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;thumbnail_qStaticContentUrl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;thumbnail_qStaticContentUrl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;thumbnail_qStaticContentUrl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;thumbnail_qStaticContentUrl_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;thumbnail_qStaticContentUrl&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qChildList&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qChildList&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qChildList_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qChildList&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;layoutOptions&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;layoutOptions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;layoutOptions_&quot;</span><span class="p">))</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;layoutOptions&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the list structure of attribute</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">explode</span><span class="p">([</span><span class="s1">&#39;cells&#39;</span><span class="p">,</span> <span class="s1">&#39;qChildList_qItems&#39;</span><span class="p">])</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;cells&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;cells_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;cells_bounds&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;cells_bounds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;cells_bounds_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cells_bounds&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qChildList_qItems&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qChildList_qItems_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qChildList_qItems_qInfo&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qChildList_qItems_qInfo_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qChildList_qItems_qMeta&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qMeta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qChildList_qItems_qMeta_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qMeta&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qChildList_qItems_qData&quot;</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_sheet_list</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qData&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qChildList_qItems_qData_&quot;</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="o">.</span><span class="n">index</span>
        <span class="n">df_sheet_list_expanded</span> <span class="o">=</span> <span class="n">df_sheet_list_expanded</span><span class="p">[</span><span class="o">~</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)]</span>
        <span class="n">df_sheet_list</span> <span class="o">=</span> <span class="n">df_sheet_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qChildList_qItems_qData&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_sheet_list_expanded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_sheet_list</span></div>



<div class="viewcode-block" id="QixEngine.get_app_variables">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_variables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with all app variables containing metadata.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with all variables from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the parameters of the session object</span>
        <span class="n">nx_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">nx_info</span><span class="p">(</span><span class="n">obj_type</span><span class="o">=</span><span class="s2">&quot;VariableList&quot;</span><span class="p">)</span>
        <span class="n">variable_list_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">variable_list_def</span><span class="p">()</span>
        <span class="n">gen_obj_props</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">generic_object_properties</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">nx_info</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;qVariableListDef&quot;</span><span class="p">,</span>
                                                               <span class="n">prop_def</span><span class="o">=</span><span class="n">variable_list_def</span><span class="p">)</span>

        <span class="c1"># Create session object</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">create_session_object</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="n">gen_obj_props</span><span class="p">)</span>

        <span class="c1"># Get session handle</span>
        <span class="n">session_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_handle</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>

        <span class="c1"># Get session object data</span>
        <span class="n">session_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">egoa</span><span class="o">.</span><span class="n">get_layout</span><span class="p">(</span><span class="n">session_handle</span><span class="p">)</span>

        <span class="c1"># Get the variable list as Dictionary structure</span>
        <span class="n">variable_list</span> <span class="o">=</span> <span class="n">session_layout</span><span class="p">[</span><span class="s2">&quot;qVariableList&quot;</span><span class="p">][</span><span class="s2">&quot;qItems&quot;</span><span class="p">]</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_variable_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qName&quot;</span><span class="p">,</span> <span class="s2">&quot;qDefinition&quot;</span><span class="p">,</span> <span class="s2">&quot;qMeta&quot;</span><span class="p">,</span> <span class="s2">&quot;qInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;qData&quot;</span><span class="p">,</span> <span class="s2">&quot;qIsScriptCreated&quot;</span><span class="p">,</span> <span class="s2">&quot;qIsReserved&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variable_list</span><span class="p">:</span>
            <span class="c1"># Concatenate the measure metadata to the DataFrame structure</span>
            <span class="n">df_variable_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_variable_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">variable</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qInfo&quot;</span>
        <span class="n">df_variable_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_variable_list</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qInfo_&quot;</span><span class="p">))</span>
        <span class="n">df_variable_list</span> <span class="o">=</span> <span class="n">df_variable_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qInfo&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_variable_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qMeta&quot;</span>
        <span class="n">df_variable_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_variable_list</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qMeta_&quot;</span><span class="p">))</span>
        <span class="n">df_variable_list</span> <span class="o">=</span> <span class="n">df_variable_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qMeta&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_variable_list_expanded</span><span class="p">)</span>

        <span class="c1"># Resolve the dictionary structure of attribute &quot;qData&quot;</span>
        <span class="n">df_variable_list_expanded</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_variable_list</span><span class="p">[</span><span class="s2">&quot;qData&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s2">&quot;qData_&quot;</span><span class="p">))</span>
        <span class="n">df_variable_list</span> <span class="o">=</span> <span class="n">df_variable_list</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;qData&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_variable_list_expanded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_variable_list</span></div>



<div class="viewcode-block" id="QixEngine.get_app_lineage">
<a class="viewcode-back" href="../../engine_api.html#qe_api_client.engine.QixEngine.get_app_lineage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_app_lineage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_handle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a list with an app lineage data.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            app_handle (int): The handle of the app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A table with lineage data from an app.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get lineage data from an app</span>
        <span class="n">lineage_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eaa</span><span class="o">.</span><span class="n">get_lineage</span><span class="p">(</span><span class="n">app_handle</span><span class="p">)</span>

        <span class="c1"># Define the DataFrame structure</span>
        <span class="n">df_lineage_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;qDiscriminator&#39;</span><span class="p">,</span> <span class="s1">&#39;qStatement&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">lineage</span> <span class="ow">in</span> <span class="n">lineage_list</span><span class="p">:</span>
            <span class="c1"># Concatenate the lineage row on the DataFrame structure</span>
            <span class="n">df_lineage_list</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_lineage_list</span><span class="p">)]</span> <span class="o">=</span> <span class="n">lineage</span>

        <span class="k">return</span> <span class="n">df_lineage_list</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rumen Vasilev.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>